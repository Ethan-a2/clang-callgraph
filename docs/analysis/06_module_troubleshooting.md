# 模块问题排查

## 模块出现问题的可能原因
- 解析失败：
  - 缺少必要的 `-I` 路径、`-D` 宏或 `-std` 标准；系统 libclang 与 Python clang 版本不匹配。
- 过滤异常：
  - `excluded_paths`/`excluded_prefixes` 设置过于宽泛导致隐藏了目标符号或边。
- 名称解析与匹配：
  - 模板/重载/命名空间导致 `FULLNAMES` 与查询词不对齐，匹配结果为空或过多。
- 调用图不完整：
  - 某些 TU 未被编译数据库覆盖；或宏展开/内联/模板特化导致引用缺失。
- 交互问题：
  - 终端输入为空或编码异常；脚本在非交互环境运行仍进入 `ask_and_print_callgraph()`。

## 模块排查步骤
1. 环境核验：
   - 确认 `clang --version` 与 `python -c 'import clang; print(clang.__version__)'`，版本一致且可加载。
2. 参数回顾：
   - 启用详细日志（临时在 `analyze_source_files` 加入计时/打印参数），核验传入的 `-I/-D/-std` 与 YAML 合并结果。
3. 最小复现：
   - 使用单文件与最小代码片段尝试，逐步增加复杂度定位问题。
4. 过滤调整：
   - 暂时移除 `-x` 与 `-p`，观察是否能得到预期调用图；然后逐步恢复过滤。
5. 数据库覆盖：
   - 检查 `compile_commands.json` 是否覆盖所有需要的源文件；对缺失部分添加或改用单文件模式。
6. 名称匹配：
   - 使用更精确的查询（包含命名空间与签名），或在交互模式下先查看 `matching:` 列表再选择。
7. 诊断处理：
   - 若存在 Error/Fatal 诊断，依据提示修正包含路径、宏定义、语言标准或源代码问题。
8. 非交互运行：
   - 在自动化场景使用 `--lookup` 指定函数，避免脚本等待输入；必要时增加超时或退出条件。
